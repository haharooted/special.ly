{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useEffect, useState, useRef } from 'react';\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Slider from '@react-native-community/slider';\nimport MapView, { Marker, Callout } from 'react-native-maps';\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar EVENTS_DATA_URL = 'https://raw.githubusercontent.com/haharooted/test/main/events.geojson';\nvar NewEventsScreen = function NewEventsScreen() {\n  var _useState = useState([]),\n    _useState2 = _slicedToArray(_useState, 2),\n    eventsData = _useState2[0],\n    setEventsData = _useState2[1];\n  var _useState3 = useState([]),\n    _useState4 = _slicedToArray(_useState3, 2),\n    filteredEvents = _useState4[0],\n    setFilteredEvents = _useState4[1];\n  var _useState5 = useState(0),\n    _useState6 = _slicedToArray(_useState5, 2),\n    sliderValue = _useState6[0],\n    setSliderValue = _useState6[1];\n  var mapRef = useRef(null);\n  var markerRefs = useRef([]);\n  var baseDate = new Date(2023, 10, 1);\n  var endDate = new Date(2024, 8, 30);\n  var daysRange = Math.floor((endDate - baseDate) / (1000 * 60 * 60 * 24));\n  useEffect(function () {\n    var _ref;\n    var fetchEventsData = function fetchEventsData() {\n      return (_ref = _ref || _asyncToGenerator(function* () {\n        try {\n          var response = yield fetch(EVENTS_DATA_URL);\n          var data = yield response.json();\n          setEventsData(data.features);\n          setFilteredEvents(data.features);\n        } catch (error) {\n          console.error('Error fetching events data', error);\n        }\n      })).apply(this, arguments);\n    };\n    fetchEventsData();\n  }, []);\n  var filterEvents = function filterEvents(daysOffset) {\n    var currentDate = new Date(baseDate.getTime());\n    currentDate.setDate(currentDate.getDate() + daysOffset);\n    var filtered = eventsData.filter(function (event) {\n      var startDate = new Date(event.properties.parsed_date_start_0);\n      var endDate = new Date(event.properties.parsed_date_end_0);\n      return startDate <= currentDate && endDate >= currentDate;\n    });\n    setFilteredEvents(filtered);\n  };\n  var handleSliderChange = function handleSliderChange(value) {\n    setSliderValue(value);\n    filterEvents(value);\n  };\n  var handleEventPress = function handleEventPress(item, index) {\n    var region = {\n      latitude: item.geometry.coordinates[1],\n      longitude: item.geometry.coordinates[0],\n      latitudeDelta: 0.0922,\n      longitudeDelta: 0.0421\n    };\n    mapRef.current.animateToRegion(region, 1000);\n    markerRefs.current[index].showCallout();\n  };\n  return _jsxs(View, {\n    style: styles.container,\n    children: [_jsx(Slider, {\n      style: styles.slider,\n      minimumValue: 0,\n      maximumValue: daysRange,\n      step: 7,\n      value: sliderValue,\n      onValueChange: handleSliderChange\n    }), _jsx(FlatList, {\n      data: filteredEvents,\n      keyExtractor: function keyExtractor(item, index) {\n        return 'key_' + index;\n      },\n      renderItem: function renderItem(_ref2) {\n        var item = _ref2.item,\n          index = _ref2.index;\n        return _jsxs(TouchableOpacity, {\n          style: styles.item,\n          onPress: function onPress() {\n            return handleEventPress(item, index);\n          },\n          children: [_jsx(Text, {\n            children: item.properties.name\n          }), _jsxs(Text, {\n            children: [\"Start: \", new Date(item.properties.parsed_date_start_0).toLocaleDateString()]\n          }), _jsxs(Text, {\n            children: [\"Slut: \", new Date(item.properties.parsed_date_end_0).toLocaleDateString()]\n          })]\n        });\n      }\n    }), _jsx(MapView, {\n      ref: mapRef,\n      style: styles.map,\n      initialRegion: {\n        latitude: 55.67377240048718,\n        longitude: 12.541496086505862,\n        latitudeDelta: 0.0922,\n        longitudeDelta: 0.0421\n      },\n      children: filteredEvents.map(function (event, index) {\n        return _jsx(Marker, {\n          ref: function ref(_ref3) {\n            return markerRefs.current[index] = _ref3;\n          },\n          coordinate: {\n            latitude: event.geometry.coordinates[1],\n            longitude: event.geometry.coordinates[0]\n          },\n          title: event.properties.name,\n          children: _jsx(Callout, {\n            children: _jsxs(View, {\n              children: [_jsx(Text, {\n                children: event.properties.name\n              }), _jsxs(Text, {\n                children: [\"Start: \", new Date(event.properties.parsed_date_start_0).toLocaleDateString()]\n              }), _jsxs(Text, {\n                children: [\"Slut: \", new Date(event.properties.parsed_date_end_0).toLocaleDateString()]\n              })]\n            })\n          })\n        }, index);\n      })\n    })]\n  });\n};\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: 'left',\n    alignItems: 'left'\n  },\n  slider: {\n    width: '100%',\n    height: 40\n  },\n  map: {\n    height: '60%',\n    width: '100%'\n  },\n  item: {\n    padding: 10,\n    borderBottomColor: '#ccc',\n    borderBottomWidth: 1\n  }\n});\nexport default NewEventsScreen;","map":{"version":3,"names":["React","useEffect","useState","useRef","StyleSheet","View","Text","FlatList","TouchableOpacity","Slider","MapView","Marker","Callout","jsx","_jsx","jsxs","_jsxs","EVENTS_DATA_URL","NewEventsScreen","_useState","_useState2","_slicedToArray","eventsData","setEventsData","_useState3","_useState4","filteredEvents","setFilteredEvents","_useState5","_useState6","sliderValue","setSliderValue","mapRef","markerRefs","baseDate","Date","endDate","daysRange","Math","floor","_ref","fetchEventsData","_asyncToGenerator","response","fetch","data","json","features","error","console","apply","arguments","filterEvents","daysOffset","currentDate","getTime","setDate","getDate","filtered","filter","event","startDate","properties","parsed_date_start_0","parsed_date_end_0","handleSliderChange","value","handleEventPress","item","index","region","latitude","geometry","coordinates","longitude","latitudeDelta","longitudeDelta","current","animateToRegion","showCallout","style","styles","container","children","slider","minimumValue","maximumValue","step","onValueChange","keyExtractor","renderItem","_ref2","onPress","name","toLocaleDateString","ref","map","initialRegion","coordinate","title","create","flex","justifyContent","alignItems","width","height","padding","borderBottomColor","borderBottomWidth"],"sources":["/Users/jkatz/git/hvaskerder/app/screens/NewEventsScreen.jsx"],"sourcesContent":["import React, { useEffect, useState, useRef } from 'react';\nimport { StyleSheet, View, Text, FlatList, TouchableOpacity } from 'react-native';\nimport Slider from '@react-native-community/slider';\nimport MapView, { Marker, Callout } from 'react-native-maps';\n\nconst EVENTS_DATA_URL = 'https://raw.githubusercontent.com/haharooted/test/main/events.geojson';\n\nconst NewEventsScreen = () => {\n  const [eventsData, setEventsData] = useState([]);\n  const [filteredEvents, setFilteredEvents] = useState([]);\n  const [sliderValue, setSliderValue] = useState(0);\n  const mapRef = useRef(null);\n  const markerRefs = useRef([]);\n\n  const baseDate = new Date(2023, 10, 1); // Base date: November 1, 2023\n  const endDate = new Date(2024, 8, 30); // End date: September 30, 2024\n  const daysRange = Math.floor((endDate - baseDate) / (1000 * 60 * 60 * 24)); // Number of days between baseDate and endDate\n\n  useEffect(() => {\n    const fetchEventsData = async () => {\n      try {\n        const response = await fetch(EVENTS_DATA_URL);\n        const data = await response.json();\n        setEventsData(data.features);\n        setFilteredEvents(data.features); // Initially display all events\n      } catch (error) {\n        console.error('Error fetching events data', error);\n      }\n    };\n\n    fetchEventsData();\n  }, []);\n\n  const filterEvents = (daysOffset) => {\n    const currentDate = new Date(baseDate.getTime());\n    currentDate.setDate(currentDate.getDate() + daysOffset);\n\n    const filtered = eventsData.filter(event => {\n      let startDate = new Date(event.properties.parsed_date_start_0);\n      let endDate = new Date(event.properties.parsed_date_end_0);\n      return startDate <= currentDate && endDate >= currentDate;\n    });\n\n    setFilteredEvents(filtered);\n  };\n\n  const handleSliderChange = (value) => {\n    setSliderValue(value);\n    filterEvents(value);\n  };\n\n  const handleEventPress = (item, index) => {\n    const region = {\n      latitude: item.geometry.coordinates[1],\n      longitude: item.geometry.coordinates[0],\n      latitudeDelta: 0.0922,\n      longitudeDelta: 0.0421,\n    };\n    mapRef.current.animateToRegion(region, 1000);\n    markerRefs.current[index].showCallout();\n  };\n\n  return (\n    <View style={styles.container}>\n      <Slider\n        style={styles.slider}\n        minimumValue={0}\n        maximumValue={daysRange} // Set the maximum value to the number of days in the range\n        step={7} // Move one week at a time\n        value={sliderValue}\n        onValueChange={handleSliderChange}\n      />\n      <FlatList\n        data={filteredEvents}\n        keyExtractor={(item, index) => 'key_' + index}\n        renderItem={({ item, index }) => (\n          <TouchableOpacity style={styles.item} onPress={() => handleEventPress(item, index)}>\n            <Text>{item.properties.name}</Text>\n            <Text>Start: {new Date(item.properties.parsed_date_start_0).toLocaleDateString()}</Text>\n            <Text>Slut: {new Date(item.properties.parsed_date_end_0).toLocaleDateString()}</Text>\n          </TouchableOpacity>\n        )}\n      />\n      <MapView\n        ref={mapRef}\n        style={styles.map}\n        initialRegion={{\n          latitude: 55.67377240048718,\n          longitude: 12.541496086505862,\n          latitudeDelta: 0.0922,\n          longitudeDelta: 0.0421,\n        }}\n      >\n        {filteredEvents.map((event, index) => (\n          <Marker\n            ref={ref => markerRefs.current[index] = ref}\n            key={index}\n            coordinate={{\n              latitude: event.geometry.coordinates[1],\n              longitude: event.geometry.coordinates[0],\n            }}\n            title={event.properties.name}\n          >\n            <Callout>\n              <View>\n                <Text>{event.properties.name}</Text>\n                <Text>Start: {new Date(event.properties.parsed_date_start_0).toLocaleDateString()}</Text>\n                <Text>Slut: {new Date(event.properties.parsed_date_end_0).toLocaleDateString()}</Text>\n                {/* Add more information as needed */}\n              </View>\n            </Callout>\n          </Marker>\n        ))}\n      </MapView>\n    </View>\n  );\n};\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    justifyContent: 'left',\n    alignItems: 'left',\n  },\n  slider: { \n    width: '100%',\n    height: 40,\n  },\n  map: {\n    height: '60%',\n    width: '100%',\n  },\n  item: {\n    padding: 10,\n    borderBottomColor: '#ccc',\n    borderBottomWidth: 1,\n  },\n});\n\nexport default NewEventsScreen;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}